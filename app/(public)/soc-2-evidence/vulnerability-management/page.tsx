import { Metadata } from 'next';
import EvidenceCategoryPage from '@/components/EvidenceCategoryPage';

export const metadata: Metadata = {
  title: 'SOC 2 Vulnerability Management Evidence Guide | RiscLens',
  description: 'Master the SOC 2 vulnerability management requirements. Learn how to document scanning, patching, and remediation for auditors.',
  alternates: {
    canonical: 'https://risclens.com/soc-2-evidence/vulnerability-management',
  },
};

export default function VulnerabilityManagementEvidencePage() {
  return (
    <EvidenceCategoryPage
      categoryName="Vulnerability Management"
      categorySlug="vulnerability-management"
      heroDescription="Vulnerability management proves that you are proactively looking for security weaknesses in your code and infrastructure, and that you have a disciplined process for fixing them."
      requirements={[
        {
          title: 'Vulnerability Scan Reports',
          description: 'Regular (typically monthly or quarterly) reports from tools like Snyk, Github Dependabot, or AWS Inspector showing the security state of your dependencies and infrastructure.',
          auditorExpectation: 'Show me your vulnerability scan report from the last three months. Were there any "Critical" or "High" findings?',
        },
        {
          title: 'Remediation Evidence',
          description: 'Documented proof (Jira tickets, PRs) that vulnerabilities identified in scans were remediated within the timeframe specified in your policy.',
          auditorExpectation: 'This "High" vulnerability was identified on July 10th. Show me the ticket where it was patched and the date it was closed.',
        },
        {
          title: 'Penetration Test Report',
          description: 'An annual report from an independent third party (like RiscLens) that tests the operational effectiveness of your security controls.',
          auditorExpectation: 'Provide the full report from your most recent third-party penetration test, including the remediation plan for any findings.',
        },
      ]}
      automationTips={[
        'Enable "Auto-remediation" (e.g., Dependabot automated PRs) for low-risk dependency updates.',
        'Integrate your scanner directly with your GRC tool to automatically sync vulnerability counts and SLAs.',
        'Use infrastructure-as-code (IaC) scanning (Checkov, Terrascan) to catch misconfigurations before they reach production.',
        'Set up automated alerting for any "Critical" vulnerabilities identified by AWS Inspector or Google Security Command Center.',
      ]}
    />
  );
}
